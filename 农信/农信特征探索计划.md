---
title: 农信特征探索计划
author: 胡明睿
date: today
email: humingrui@zhejianglab.com
---

[toc]

### 一、BG: 现有特征及目标

- 包括离散型数据， ID类数据， 数值型数据等。
- 考虑到数据类型的多样性及相似性， 我们主要参考推荐领域的特征处理方法。
- 目标： 探索更多业务可用特征， 主要考虑对目标的影响，可解释性等。 

### 二、 特征工程常用方法

- [特征交叉][3]：低阶/高阶
  - LR本身只考虑各特征的独立影响， 但特征间常具有关联性，需要考虑特征相互影响
- 特征筛选：
  - 大量扩充出的高维特征需要进行筛选， 从而过滤掉噪音特征、相关度过高的冗余特征等
  - [常用方法][4]：
    - 过滤式： 基于iv， 特征重要性(基尼系数， 信息增益比等)， Pearson相关性系数等
    - 包裹式:   e.g. LVW方法
    - 嵌入式：Model-based feature selection
- 时序特征算子融合
  - 对时间序列，原始值可能并不能反映实际趋势
  - 常用数值类时序特征处理方法：
    - 时序分解： ARIMA类
    - 时序算子：方差， Z-score， entropy， fft等
- 自动特征工程
  - 以上特征工程方法仍需要进行手动特征转换， 特征筛选等， 且重度依赖专家经验
  - 自动特征工程作为自动机器学习(AutoML)的一部分， 目标是 解放人力， 探索更有价值的特征组合
  - 目前自动特征工程方法主要关注 tabular (&categorical) data
  - 工业级AutoFE主要基于分布式系统(如参数服务器等)进行算力优化， 实现相对复杂

### 三、计划

我们参考上述各特征工程方法的[工业应用成熟度][1]、实现复杂度、可解释性等方面， 从*特征交叉*和*融合动态历史行为信息*两个方面入手， 列出初步的探索计划。

#### 1. 特征交叉：

- **Milestone 1**： GBDT(RF) + LR

  使用GBDT探索高阶特征交叉， 将新特征及原始特征共同输入LR进行评分。优点： 可解释强， 每一条决策路径都可视为一个新的交叉特征

- **Milestone 2**： FM + LR

  - 因子分解机考虑二阶特征交叉， 形式简单， 与LR自然融合

- **Milestone 3**： [DNN-based 高阶特征交叉探索][2]

  这种方式使用深度模型对高阶交叉进行了自然建模，方便针对不同类型业务特征进行定制化调整及组合。

  可以与FM结合。缺点：由于使用了DNN，可解释性下降。

  - Wide&Deep
  - DeepFM & xDeepFM

- **Milestone 4**：自动特征工程

  以下考虑两种基于两阶段迭代的自动特征工程方法: [**AutoCross**][5] 及 [**SAFE** ][6]

  a. 两个方法中都对计算复杂度进行了优化，并且考虑了分布式能力以便适应较大的业务数据集。同时，他们在缩减特征子集空间， 能够探索的特征算子， 及实现复杂度上都有一定差别。 

  b. *两阶段自动特征工程*的基本思想是： 定义一个特征算子集(Operators)，而后分两阶段进行特征子集探索：

  - Stage 1： 特征生成(Feature Generation)
  - Stage 2： 特征筛选(Feature Selection)
    - 新特征子集效果验证: Feature Evaluation
  - 上述两阶段不断迭代，直到满足终止条件：例如特征子集数量达到要求， 优化目标达到预期效果， 算力/时间达到设定目标等

  c. 两者简单对比如下(以下简称AC和SAFE):

  ​	1) *Terminating Condition*： AC + early stopping

  ​	2) Ways to *reduce base feature space* at each iteration：

  ​		   - AC：beam search

  ​          - SAFE：xgboost

  ​	3) *Operators* to generate new features

  ​			- AC: multi-granularity discretization + feature-crossing(product)

  ​			- AC $\subset$ SAFE

  ​	4) *Feature Selection & Evaluation*

  ​				AC: model-based only

  ​					- narrow-down evaluation space & save compuation resources: successive minibatch GD 

  ​					- evaluation model: field-wise LR

  ​				SAFE: pipeline

  ​					- narrow-down evaluation space: iv + pearson correlation

  ​					- evaluation model: xgboost

#### 2. 结合更多动态历史信息：

考虑对客户的历史行为 (e.g.已经逾期情况) 进行建模， 区分异常行为序列， 可能逾期的行为序列及正常序列。

以下仅提供时序分析的一些可能的方式列表， 具体方法需要针对业务数据进行选择。

- 方法1：

  时序特征聚合: 例如直接对历史行为进行频率计数， 从而转换为一般特征
- 方法2：

  对序列信息进行单独建模，包括时序特征扩充等， 而后与常规评分模型进行融合

  - 时序特征自动扩充:

    - [featuretools](https://www.featuretools.com/)
    - [tsfresh](https://tsfresh.readthedocs.io/en/latest/)
    - [TSFEL](https://github.com/jingmouren/tsfel)
    
  - 传统统计方式：

    - STL分解， 变点、折点分析等
    - ARIMA类， 依据自相关性等进行建模
    - [Facebook Prophet][8]
    
  - DTW序列相似度比较

    - 可能需要进行滤波， 例如Kalman Filter等state-space方法
    - 需要进行阈值设定， 专家经验或通过遗传算法等

  - 传统序列模型如HMM等

  - NN-based建模

    - 一般序列模型
      - lstm， transformer
        - AWS [DeepAR][9]
      - 针对长距离时间序列： Informer (timestamp embedding + 金字塔结构 + ProbSparseAttention)
      - TCN
    - 转化为动态图挖掘shapelets间关系 -> Time2Graph 及其后续
      - 工业应用： [阿里云流式日志异常检测SLS][7]

    - ST-Graph
      - 构建时空图， 建立节点间关系并通过序列模型对时间序列进行建模

### 参考链接

[1]: https://mp.weixin.qq.com/s?__biz=MzU1NTMyOTI4Mw==&mid=2247547724&idx=1&sn=f233020e841cf168a5652a2243522f73&chksm=fbd78920cca000365a5808010447c13a4eb533669e5100005f637faf59378ee279c6cde2637f&scene=90&subscene=93&sessionid=1629119163&clicktime=1629119194&enterid=1629119194&ascene=56&devicetype=android-29&version=280009a0&nettype=WIFI&abtest_cookie=AAACAA%3D%3D&lang=zh_CN&exportkey=AST0EebSqiJ7C9PjdqGt7Jc%3D&pass_ticket=8iZEmdJUi5PH25pGpHCX8jKz0wOmP93TjRzrBFm9haA21kavCfJoYefEYS9Do%2FXM&wx_header=1	"斗鱼风控体系建设"
[2]: https://zhuanlan.zhihu.com/p/79493572 "深度学习特征交叉综述"
[3]: https://segmentfault.com/a/1190000014799038 "特征组合与特征交叉"

[4]: https://null "西瓜书"
[5]: https://segmentfault.com/a/1190000021328618 "罗远飞：自动特征工程在推荐系统中的研究"

[6]: https://ieeexplore.ieee.org/document/9101784 "SAFE:Scalable Automatic Feature Engineering Framework for Industrial Tasks"

[7]: https://help.aliyun.com/document_detail/172129.html?spm=a2c4g.11186623.6.1128.23d0659d0vQCXO	"阿里云SLS"
[8]: https://facebook.github.io/prophet/ "Prophet: Forecasting at scale"
[9]: https://aws.amazon.com/cn/blogs/china/time-series-prediction-with-deep/?nc1=b_rp "使用 DeepAR 进行时间序列预测"

