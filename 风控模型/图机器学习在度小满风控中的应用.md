## 图机器学习在度小满风控中的应用

- 李宗纯 度小满 AI产品经理

- 本文主要介绍度小满的超大规模图平台，以及它在真实金融风控业务中的应用。

### 1. 金融风控技术演进

- ![图片](%E5%9B%BE%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9C%A8%E5%BA%A6%E5%B0%8F%E6%BB%A1%E9%A3%8E%E6%8E%A7%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8.assets/640.png)
  - **第一阶段-审核**：主要依赖对信息的人工审核。但身**份证、手机号码、银行流水等材料的伪造**成本很低，金融机构需投入大量人力审核信息主体的身份及材料的真实性
  - **第二阶段-规则**：基于**数据分析**而制定的**各种策略和规则**：通过收集大量多样化的数据，如第三方信息等对信息的真实性进行交叉验证。比传统的人工审核具有更强的反欺诈能力。但由于数据来源多、规模日益庞大，如何**整合多元异构数据源**，**利用已有数据交叉验证**成为新挑战
  - **第三阶段-模型**：用机器学习模型，将多源异构的大数据整合成机器可以理解的知识，通过机器学习模型来判断节点的好与坏
  - **第四阶段-知识图谱**：将单点身份和单条链路的资料转换成对于面的形式的风险检测，不仅关注节点个体本身，而是更加**关注个体之间的关系**，从而实现欺诈的识别和防御。

### 2. 图在金融领域的演进

![图片](%E5%9B%BE%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9C%A8%E5%BA%A6%E5%B0%8F%E6%BB%A1%E9%A3%8E%E6%8E%A7%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8.assets/640-16461142336982-16461142349074.png)

### 3. 图平台Eros框架

![图片](%E5%9B%BE%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9C%A8%E5%BA%A6%E5%B0%8F%E6%BB%A1%E9%A3%8E%E6%8E%A7%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8.assets/640-16461143068595-16461143089457.png)



- **底层基础设施**：海量的关联数据池，异构计算集群资源，大规模高性能数据库。
- **图数据库**：存储各类的**关系型的数据**，如企业和人和证件间的关系等。
- Eros平台主要应用在**金融信贷的全链路场景**当中，从一开始的智能获客到智能反欺诈，智能风控和贷后审核等。

### 4. 图存储模块

![-](%E5%9B%BE%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9C%A8%E5%BA%A6%E5%B0%8F%E6%BB%A1%E9%A3%8E%E6%8E%A7%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8.assets/640-16461144749578-164611447599210.png)

- **存储规模**：支持千亿节点千亿边的超大图存储，具有可扩展可伸缩的存储和计算能力；
- **高性能**：毫秒级响应，二度查询50ms以下，可以说是业界比较领先的一个水平；
- **查询分析一体化**：同时支持同查询和图分析算法；
- **简单易用的一站式图平台**：良好的可视化界面，助力用户快速查询。

### ==5. 图分析模块==

![图片](%E5%9B%BE%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9C%A8%E5%BA%A6%E5%B0%8F%E6%BB%A1%E9%A3%8E%E6%8E%A7%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8.assets/640-164611463134111-164611463264513.png)

- 对于**图分析**算法，我们可以将其按照顶点、边、社团来进行划分，分别支持各类图分析算法
- 对于**图表示**学习，也支持基于因子分解、随机游走和深度学习等方法的图算法

### 6. 图建模

![图片](%E5%9B%BE%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9C%A8%E5%BA%A6%E5%B0%8F%E6%BB%A1%E9%A3%8E%E6%8E%A7%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8.assets/640-164611477416414-164611477558816.png)

- AutoGraph可以在无人工参与的情况下，自动生产**直推式图结构嵌入特征**，并通过增量式训练和**异构图算法**支持，增加对最新数据和复杂图数据的覆盖

### 7. 可视化模块

![图片](%E5%9B%BE%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9C%A8%E5%BA%A6%E5%B0%8F%E6%BB%A1%E9%A3%8E%E6%8E%A7%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8.assets/640-164612347202217-164612347346519.png)

- 宏观：查看一个图网络结构、点边分布和统计信息
- 微观：图N度邻居查询、关键信息展示、基于条件的过滤与统计功能
- 基础的图管理功能：
  - 图导入导出：用户可以自定义要导入的数据、任务的启停时间和周期等；也可以从异构大图中导出子图；
  - 实例监控管理：查看数据分布以及健康性；
  - 训练管理：选择模型和数据进行训练。
- 从节点、路径、社团不同级别分别提供了可视化功能：
  - 可疑节点分析、关系可视化、路径标记和社团发现等，可以分别应用于反欺诈、审核、反洗钱等环节。

### 8. 应用

#### 8.0

![图片](%E5%9B%BE%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9C%A8%E5%BA%A6%E5%B0%8F%E6%BB%A1%E9%A3%8E%E6%8E%A7%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8.assets/640-164612363839620-164612363950722.png)

- 应用可以从**贷前到贷中一直贯穿到贷后**整个流程，所以它的用户也可以覆盖到**算法、策略、信审以及反洗钱**等不同角色不同团队。
  - 对于**算法**同学，他们更多的使用场景是图建模，图挖掘。他们更关心的是快速的进行图实验，并且快速、直观的得到实验结果。所以我们的产品就可以为其提供自动的数据预处理，自动的特征工程，自动建模调参，自动部署上线等功能。
  - 对于**策略**的同学，他们使用这个平台做反欺诈分析，所以他们希望能够在这个平台**查询某一个节点的风险是怎样的一个等级**。为他们提供的是可疑节点标记和可疑社团标记。
  - 对于**信审**审核同学，他们既往的审核工作往往是通过在互联网各种平台上进行多个轮次的搜索，过程繁琐且不直观。所以图平台主要是**提升他们的工作效率**，使他们查询和审核的过程更加快速，更加直观，更加便捷。为他们提供的功能包括人企关联查询，企业风险提示和特殊关系提示等；
  - 对于**反洗钱**团队，我们希望为他们在**追踪资金链路**以及**关键节点**当中提供一些帮助，辅助他们的工作提升效率。所以也相应的为他们推**关键路径分析和关键节点识别**的一些功能。

#### 8.1 智能图挖掘

- ![图片](%E5%9B%BE%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9C%A8%E5%BA%A6%E5%B0%8F%E6%BB%A1%E9%A3%8E%E6%8E%A7%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8.assets/640-164612377740123-164612377878825.png)

  - **Step5：一键产出OOT打分**

    用户只需要配置他们所需要打分的月份或数据，就可以一键产出打分结果。

  - 案例一： 基于征信数据的图关联网络

    ![图片](%E5%9B%BE%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9C%A8%E5%BA%A6%E5%B0%8F%E6%BB%A1%E9%A3%8E%E6%8E%A7%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8.assets/640-164612386787526.png)

    - 基于征信数据的图模型充分挖掘了**用户在空间、时间上的特征**，以及**用户和企业之间的关联关系**，其中用户节点有10亿+，包含了用户的基础风险特征，征信风险特征等；还包括了一些公司节点和位置节点。区别于传统的关联网络，图神经网络是基于**异构图**以及**全网用户的实时更新**的风险特征属性来建立的一个端到端的**深度实时模型**，而传统的关联网络往往只是依赖于节点之间关联的紧密程度。智能图挖掘帮助我们在复杂的模型自动地寻找高级高阶的组合特征，而不仅仅是依赖于专家的一些经验来加工有限的特征。

  - 案例二: 风控模型中的小微关联网络
    - ![图片](%E5%9B%BE%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9C%A8%E5%BA%A6%E5%B0%8F%E6%BB%A1%E9%A3%8E%E6%8E%A7%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8.assets/640-164612403755328-164612403954830.png)
    - 基于风控数据的图子模型，这个模型适用于信贷风险分析，判断用户的风险。模型**引入了实体和实体的关系**，包括**人和人、人和公司之间的关系**等。具有12亿顶点和80亿边，其中每**个人又选择了94维以征信为主的特征**。这个模型的网络结构设计了**双层的GraphSAGE和GAT融合**的模型。利用智能图挖掘的功能之后，整体的模型效果对于**风控的AB卡有1%以上**的效果提升。

#### 8.2 智能反欺诈：

##### 8.2.1  图可视化和图分析

- ![图片](%E5%9B%BE%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9C%A8%E5%BA%A6%E5%B0%8F%E6%BB%A1%E9%A3%8E%E6%8E%A7%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8.assets/640-164612415893531.png)
- 当用户输入需要查询的节点信息后，可以基于过滤条件自定义查询相关节点以及关系信息。
- 宏观： 如这个节点所处的社团的点边分布等
- 细粒度： 部分关键信息，这个关键信息可以辅助策略进行一些反欺诈分析， 包括：社团当中的各个节点的分层信息、社团总申请数量、社团组总欺诈率、违约率等

##### 8.2.2 基于一致性检验技术，社团发现的一键式风险检测功能：

- ![图片](%E5%9B%BE%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9C%A8%E5%BA%A6%E5%B0%8F%E6%BB%A1%E9%A3%8E%E6%8E%A7%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8.assets/640-164612441080533-164612441217135.png)

- 同时检测个人欺诈和团购团伙欺诈
- 个人欺诈行为：通过 **度中心性、紧密中心性、介数中心度及特征向量中心**等指标， 分析各节点的信息度量，**判定与其关联的人是否存在于黑名单中**，或是根据**==一致性分析判断三角关系是否成立==**，来为其欺诈风险进行分级。
- 团伙欺诈: 事件发生的**频率更高**，团伙往往具有明确的分工和计划，熟悉目标平台的各项业务流程，**欺诈手段是非常复杂且多变**的。对于团伙欺诈，我们的平台主要是提供对关键节点、关键路径和关键社区发现和标记的功能。
  - **关键节点**：星状节点。金融领域较为常见的一个**羊毛党**的网络结构，它极有可能是一个人通过群控很多人从而实现团伙欺诈。
  - **关键路径**：链状路径。团伙欺诈时为了节省成本，往往多数人共用一套身份信息（如身份证、手机号、住址、联系人等）；一个节点连接多个社区且社区内人群多数信贷不良，那么这个路径上的团伙很可能是**黑产或黑中介**。
  - **关键社区**：完全子图。任意两点都相连的图具有较高的风险性。这种网络内的人相互都有关联，这种也是目前很容易识别的欺诈团伙。
- 还可借助关联图谱的可视化分析功能，如节点**查询、关系扩散、节点pagerank值计算、最短路径分析、图谱信息统计**等功能，辅助我们进行分析和审核。

#### 8.3 智能反洗钱

- ![图片](%E5%9B%BE%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9C%A8%E5%BA%A6%E5%B0%8F%E6%BB%A1%E9%A3%8E%E6%8E%A7%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8.assets/640-164612468074236.png)
  - 比如一些频繁汇入汇出，集中汇入汇出交易，很可能存在较高洗钱风险。

#### 8.4 智能审核

![图片](%E5%9B%BE%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9C%A8%E5%BA%A6%E5%B0%8F%E6%BB%A1%E9%A3%8E%E6%8E%A7%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8.assets/640-164612489590838-164612489705740.png)

- 利用知识图谱技术，融合OCR以及NLP技术，平台上可以自动实现**进件秒批**。当用户在手机端提交材料， OCR技术将会对文字信息进行检测、识别以及结构化提取，同时进行质量检测和篡改检测。接着利用NLP的技术进行文本分词、分类和**关键词识别**。最后送入知识图谱，完成**信息抽取**和信息可视化，最终实现自动秒批。

##### 8.4.1 案例：企业风险评估

![图片](%E5%9B%BE%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9C%A8%E5%BA%A6%E5%B0%8F%E6%BB%A1%E9%A3%8E%E6%8E%A7%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8.assets/640-164612499668641-164612499900443.png)

- 信审人员可以在平台上实时去查询企业投资或涉诉的信息，包括企业最终控制人等，不需要再跳转至其他平台去进行多轮次的搜索。它能够**提升审核的效率，降低人工成本**。
- 对于每一个进件，平台都为它提供三层网络的搜索可视化：首先关联到提交证件里的提交人，提交人相关的**空间时序、征信风险等信息**都会展示出来；其次会关联到提交人所关联的企业信息；第三，与跟这个企业存在关联的二度关联人的信息也可以在平台当中查询得出。

### QA

#### Q1： 社区的客户分层是什么意思？

- A：社区分层是指通过各类风控指标，用户风控属性的一些评估所给到用户的一个不同的分层，或者是平台上给到企业的不同分层，比如某个企业涉诉的情况很多，或者它的上下游企业出现过破产倒闭这些行为，它的**风险等级就会更高**，我们可能会利用红色突出展示。

Q：关联的人或企业数据，没有授权，你们是如何做到融合的？

A：度小满用的数据都是已经授权的，不会使用没有授权的。

Q：人与人之间的数据是怎么获得的，可以利用来做一个研究的共享吗？

A：平台用的比较多的是人与企业和企业与企业之间的关系数据。我们会根据征信报告去解读这些关系信息。